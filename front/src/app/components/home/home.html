<div class="app-layout">
  <!-- üîπ SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <a class="sidebar-brand" routerLink="/">
        <span class="brand-name">FotolJay</span>
      </a>
    </div>

    <nav class="sidebar-nav">
      <a routerLink="/" class="sidebar-link active">üè† Accueil</a>
      <a routerLink="/seller-auth" class="sidebar-link">üßç‚Äç‚ôÇÔ∏è Espace Vendeur</a>
      <a routerLink="/sell" class="sidebar-link">‚ûï Vendre un produit</a>
      <a routerLink="/login" class="sidebar-link">üõ°Ô∏è Connexion Admin</a>
    </nav>
  </aside>

  <!-- üîπ CONTENU PRINCIPAL -->
  <div class="main-container">
    <!-- IMAGE DE FOND -->
    <div class="background-container">
      <div class="background-overlay"></div>
      <img src="/assets/images/Doveva_Fashion.png" alt="background" class="background-image" />
    </div>

    <!-- CONTENU CENTRAL -->
    <main class="main-content">
      <h1 class="hero-title">FOTOL JAY</h1>
      <p class="hero-subtitle">
        D√©couvrez notre collection unique de photos authentiques
      </p>

      <div class="hero-actions">
        <a routerLink="/login" class="hero-btn primary">Se connecter</a>
        <a routerLink="/sell" class="hero-btn secondary">Vendre</a>
      </div>

      <div class="search-card">
        <form (ngSubmit)="onSearch()" class="search-form">
          <input
            type="text"
            [value]="searchTerm()"
            (input)="searchTerm.set($any($event.target).value)"
            name="search"
            placeholder="Rechercher un produit..."
          />
          <button type="submit">üîç Rechercher</button>
        </form>
      </div>
    </main>

    <!-- SECTION PRODUITS -->
    <section class="products-section">
      <div class="container">
        <h2 class="section-title">Produits Disponibles</h2>

        <!-- Loading -->
        @if (loading()) {
        <div class="loading">
          <div class="spinner"></div>
          <p>Chargement des produits...</p>
        </div>
        }

        <!-- Liste des produits -->
        @else { @if (products().length === 0) {
        <div class="empty-state">
          <p>Aucun produit disponible pour le moment</p>
        </div>
        } @else {
        <div class="products-grid">
          @for (product of products(); track product.id; let i = $index) {
          <div class="product-card" [style]="'--animation-order: ' + i">
            <div class="product-image">
              <img
                [src]="getPrimaryPhoto(product)"
                [alt]="product.title"
                [title]="product.title"
                class="product-image"
                (error)="$any($event.target).src = '/placeholder.svg'"
              />
            </div>
            <div class="product-body">
              @if (product.isVip) {
              <span class="badge badge-vip">
                <lucide-icon [img]="Star" [size]="16"></lucide-icon>
                VIP
              </span>
              }
              <h3 class="product-title">{{ product.title }}</h3>
              <p class="product-description">{{ product.description }}</p>

              <!-- Informations du vendeur -->
              <div class="product-seller">
                <div class="seller-header">
                  <lucide-icon [img]="User" [size]="16" class="seller-icon"></lucide-icon>
                  <span class="seller-label">Vendeur</span>
                </div>
                <div class="seller-name">
                  {{ product.seller.firstName || 'N/A' }} {{ product.seller.lastName || '' }}
                </div>
                <div class="seller-contact">
                  @if (product.seller.email) {
                  <a
                    [href]="'mailto:' + product.seller.email"
                    class="contact-link"
                    title="Contacter par email"
                  >
                    <lucide-icon [img]="Mail" [size]="16"></lucide-icon>
                    <span class="contact-text">Email</span>
                  </a>
                  } @if (product.seller.phone) {
                  <a
                    [href]="'tel:' + product.seller.phone"
                    class="contact-link"
                    title="Contacter par t√©l√©phone"
                  >
                    <lucide-icon [img]="Phone" [size]="16"></lucide-icon>
                    <span class="contact-text">T√©l√©phone</span>
                  </a>
                  }
                </div>
              </div>

              <div class="product-footer">
                <span class="product-views">
                  <lucide-icon [img]="Eye" [size]="16"></lucide-icon>
                  {{ product.views }} vues
                </span>
                <button class="btn btn-sm btn-primary" (click)="viewProduct(product, $event)">
                  Voir d√©tails
                </button>
              </div>
            </div>
          </div>
          }
        </div>
        } }
      </div>
    </section>
  </div>

  <!-- MODAL PRODUIT -->
  @if (showModal() && selectedProduct(); as product) {
  <div class="modal-overlay" (click)="closeModal()">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <button class="modal-close-btn" (click)="closeModal()" aria-label="Fermer">
        <lucide-icon [img]="X" [size]="24"></lucide-icon>
      </button>

      <!-- Images Gallery -->
      <div class="modal-gallery">
        @for (photo of product.photos; track photo.id) {
        <img
          [src]="getPrimaryPhoto(product)"
          [alt]="'Photo ' + ($index + 1)"
          [title]="'Photo ' + ($index + 1) + ' de ' + product.title"
          class="modal-gallery-image"
          (error)="$any($event.target).src = '/placeholder.svg'"
        />
        }
      </div>

      <!-- Product Info -->
      <div class="modal-content">
        <div class="modal-header-section">
          @if (product.isVip) {
          <span class="badge badge-vip">
            <lucide-icon [img]="Star" [size]="16"></lucide-icon>
            VIP
          </span>
          }
          <h2 class="modal-title">{{ product.title }}</h2>
          <div class="modal-meta">
            <span class="meta-item">
              <lucide-icon [img]="Eye" [size]="16"></lucide-icon>
              {{ product.views }} vues
            </span>
          </div>
        </div>

        <div class="modal-section">
          <h3 class="modal-section-title">Description</h3>
          <p class="modal-description">{{ product.description }}</p>
        </div>

        <div class="modal-section">
          <h3 class="modal-section-title">
            <lucide-icon [img]="User" [size]="20"></lucide-icon>
            Informations du vendeur
          </h3>
          <div class="seller-contact">
            <div class="contact-item">
              <lucide-icon [img]="User" [size]="18" class="contact-icon"></lucide-icon>
              <div>
                <span class="contact-label">Nom du vendeur</span>
                <span class="contact-value"
                  >{{ product.seller.firstName || 'N/A' }} {{ product.seller.lastName || '' }}</span
                >
              </div>
            </div>
            @if (product.seller.email) {
            <a [href]="'mailto:' + product.seller.email" class="contact-item contact-link">
              <lucide-icon [img]="Mail" [size]="18" class="contact-icon"></lucide-icon>
              <div>
                <span class="contact-label">Email</span>
                <span class="contact-value">{{ product.seller.email }}</span>
              </div>
            </a>
            } @if (product.seller.phone) {
            <a [href]="'tel:' + product.seller.phone" class="contact-item contact-link">
              <lucide-icon [img]="Phone" [size]="18" class="contact-icon"></lucide-icon>
              <div>
                <span class="contact-label">T√©l√©phone</span>
                <span class="contact-value">{{ product.seller.phone }}</span>
              </div>
            </a>
            }
          </div>
        </div>
      </div>
    </div>
  </div>
  }
</div>
