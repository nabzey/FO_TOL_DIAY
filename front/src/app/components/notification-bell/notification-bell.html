<div class="notification-bell-container">
  <button 
    class="bell-button" 
    (click)="toggleDropdown()"
    [class.has-notifications]="notificationService.unreadCount() > 0"
    aria-label="Notifications"
  >
    <lucide-icon [img]="Bell" [size]="20"></lucide-icon>
    @if (notificationService.unreadCount() > 0) {
      <span class="notification-badge">{{ notificationService.unreadCount() }}</span>
    }
  </button>

  @if (showDropdown()) {
    <div class="notification-dropdown">
      <div class="dropdown-header">
        <h3>Notifications</h3>
        <div class="dropdown-actions">
          @if (notificationService.notifications().length > 0) {
            <button class="btn-icon" (click)="markAllAsRead()" title="Tout marquer comme lu">
              <lucide-icon [img]="CheckCheck" [size]="16"></lucide-icon>
            </button>
            <button class="btn-icon" (click)="clearAll()" title="Tout effacer">
              <lucide-icon [img]="X" [size]="16"></lucide-icon>
            </button>
          }
        </div>
      </div>

      <div class="notifications-list">
        @if (notificationService.notifications().length === 0) {
          <div class="empty-notifications">
            <p>Aucune notification</p>
          </div>
        } @else {
          @for (notification of notificationService.notifications(); track notification.id) {
            <div 
              class="notification-item"
              [class.unread]="!notification.read"
              [class.success]="notification.type === 'success'"
              [class.error]="notification.type === 'error'"
              [class.warning]="notification.type === 'warning'"
              [class.info]="notification.type === 'info'"
              (click)="markAsRead(notification.id)"
            >
              <div class="notification-icon">{{ getNotificationIcon(notification.type) }}</div>
              <div class="notification-content">
                <p class="notification-message">{{ notification.message }}</p>
                <span class="notification-time">{{ notification.timestamp | date:'short' }}</span>
              </div>
              <button 
                class="notification-close" 
                (click)="removeNotification(notification.id, $event)"
                aria-label="Fermer"
              >
                <lucide-icon [img]="X" [size]="14"></lucide-icon>
              </button>
            </div>
          }
        }
      </div>
    </div>

    <div class="dropdown-overlay" (click)="closeDropdown()"></div>
  }
</div>
